<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>My Account</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Small alignment touch-ups just for the account page */
    header {
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; padding:16px 20px;
    }
    header .right { display:flex; gap:10px; align-items:center; }
    .btn { padding:10px 14px; border:1px solid #b47b82; border-radius:8px; color:#7b3942; }
    .btn.ghost { background:#fff4f6; }
    .btn.primary { background:#b47b82; color:#fff; border-color:#b47b82; }
    .row { display:flex; gap:12px; align-items:center; }
    .field { display:flex; flex-direction:column; gap:6px; }
    .form-row { display:grid; grid-template-columns:1fr 1fr; gap:14px; align-items:end; }
    @media (max-width:700px){ .form-row{ grid-template-columns:1fr; } }
    .muted { color:#7c7c7c; font-size:0.95rem; }
    .card { background:#fff; border:1px solid #eee; border-radius:14px; padding:16px; }
    #authMsg { color:#a13745; margin-top:6px; }
    #msg { margin-top:8px; color:#3c6c3c; }
  </style>
</head>
<body>

<header>
  <a href="index.html" class="btn ghost">← Back to Store</a>
  <h1 style="margin:0">My Account</h1>
  <div class="right">
    <a href="feedback.html" class="btn">Feedback</a>
    <button id="logoutBtn" class="btn ghost" style="display:none">Logout</button>
  </div>
</header>

<main class="container" style="padding:12px 20px; max-width:980px; margin:auto">

  <!-- AUTH GATE -->
  <section id="authGate" class="card">
    <h2 style="margin-top:0">Sign in</h2>
    <form id="signinForm" class="form-row" autocomplete="on" novalidate>
      <div class="field">
        <label for="loginEmail">Email</label>
        <input id="loginEmail" type="email" required />
      </div>
      <div class="field">
        <label for="loginPass">Password</label>
        <input id="loginPass" type="password" required />
      </div>
      <div class="row" style="grid-column:1/-1">
        <button id="loginBtn"  type="submit" class="btn primary">Sign in</button>
        <button id="signupBtn" type="button" class="btn">Create account</button>
      </div>
    </form>
    <p id="authMsg" class="muted"></p>
  </section>

  <!-- APP AFTER LOGIN -->
  <section id="app" style="display:none">
    <section class="card" style="margin-bottom:16px">
      <h2 style="margin-top:0">Quick checkout</h2>

      <div class="row" style="flex-wrap:wrap; gap:14px">
        <div class="field">
          <label>Product</label>
          <select id="pSel"></select>
        </div>

        <div class="field">
          <label>Ownership</label>
          <select id="ownSel">
            <option value="solo">Solo</option>
            <option value="shared">Shared</option>
          </select>
        </div>

        <div class="field">
          <label>Type</label>
          <select id="credSel">
            <option value="account">Account</option>
            <option value="profile">Profile</option>
          </select>
        </div>

        <div class="field">
          <label>Duration</label>
          <select id="durSel">
            <option value="7">7 days</option>
            <option value="14">14 days</option>
            <option value="30" selected>1 month</option>
            <option value="60">2 months</option>
            <option value="90">3 months</option>
            <option value="120">4 months</option>
            <option value="150">5 months</option>
            <option value="180">6 months</option>
            <option value="210">7 months</option>
            <option value="240">8 months</option>
            <option value="270">9 months</option>
            <option value="300">10 months</option>
            <option value="330">11 months</option>
            <option value="360">12 months</option>
          </select>
        </div>

        <div class="field">
          <label>Amount</label>
          <div id="amountTxt" style="font-weight:700; padding:10px 0">₱0.00</div>
        </div>
      </div>

      <div class="divider" style="height:1px;background:#eee;margin:12px 0"></div>

      <div class="row" style="gap:18px; flex-wrap:wrap">
        <div class="row">
          <label><input type="radio" name="pm" value="gcash" checked> GCash</label>
          <label style="margin-left:12px"><input type="radio" name="pm" value="maya"> Maya</label>
        </div>

        <div id="gcashInfo" class="row" style="display:flex">
          <span class="muted">Send to</span>
          <b id="gcashNum">09XX-XXX-XXXX</b>
        </div>
        <div id="mayaInfo" class="row" style="display:none">
          <span class="muted">Send to</span>
          <b id="mayaNum">09YY-YYY-YYYY</b>
        </div>
      </div>

      <div class="row" style="margin-top:10px; flex-wrap:wrap; gap:14px">
        <div class="field">
          <label>Reference # (optional until paid)</label>
          <input id="refNo" placeholder="GCash/Maya Ref #" />
        </div>
        <div class="field">
          <label>Time sent (optional)</label>
          <input id="sentAt" type="datetime-local" />
        </div>
        <div class="field">
          <label>Upload receipt (optional)</label>
          <input id="receiptFile" type="file" accept="image/*,application/pdf" />
        </div>
      </div>

      <div class="row" style="margin-top:12px">
        <button id="placeBtn" class="btn primary">Place order</button>
        <span id="msg" class="muted"></span>
      </div>
    </section>

    <section class="card">
      <h2 style="margin-top:0">My Orders</h2>
      <div id="ordersBox" class="col"></div>
    </section>
  </section>

</main>

<!-- Make sure app.js loads first (creates the supabase client), then account.js -->
<script src="app.js"></script>
<script src="account.js"></script>
</body>
</html>
